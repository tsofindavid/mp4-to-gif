{"ast":null,"code":"import { Data, UID } from '@symbiotejs/symbiote';\nconst MSG_NAME = '[Typed State] Wrong property name: ';\nconst MSG_TYPE = '[Typed State] Wrong property type: ';\nexport class TypedData {\n  /**\n   * @param {Object<string, { type: any; value: any; nullable?: Boolean }>} typedSchema\n   * @param {String} [ctxName]\n   */\n  constructor(typedSchema, ctxName) {\n    /** @private */\n    this.__typedSchema = typedSchema;\n    /** @private */\n    this.__ctxId = ctxName || UID.generate();\n    /** @private */\n    this.__schema = Object.keys(typedSchema).reduce((acc, key) => {\n      acc[key] = typedSchema[key].value;\n      return acc;\n    }, {});\n    /**\n     * @private\n     * @type {Data}\n     */\n    this.__data = Data.registerCtx(this.__schema, this.__ctxId);\n  }\n\n  /** @returns {String} */\n  get uid() {\n    return this.__ctxId;\n  }\n\n  /**\n   * @param {String} prop\n   * @param {any} value\n   */\n  setValue(prop, value) {\n    if (!this.__typedSchema.hasOwnProperty(prop)) {\n      console.warn(MSG_NAME + prop);\n      return;\n    }\n    let pDesc = this.__typedSchema[prop];\n    if (value?.constructor === pDesc.type || value instanceof pDesc.type || pDesc.nullable && value === null) {\n      this.__data.pub(prop, value);\n      return;\n    }\n    console.warn(MSG_TYPE + prop);\n  }\n\n  /** @param {Object<string, any>} updObj */\n  setMultipleValues(updObj) {\n    for (let prop in updObj) {\n      this.setValue(prop, updObj[prop]);\n    }\n  }\n\n  /** @param {String} prop */\n  getValue(prop) {\n    if (!this.__typedSchema.hasOwnProperty(prop)) {\n      console.warn(MSG_NAME + prop);\n      return undefined;\n    }\n    return this.__data.read(prop);\n  }\n\n  /**\n   * @param {String} prop\n   * @param {(newVal: any) => void} handler\n   */\n  subscribe(prop, handler) {\n    return this.__data.sub(prop, handler);\n  }\n  remove() {\n    Data.deleteCtx(this.__ctxId);\n  }\n}","map":{"version":3,"names":["Data","UID","MSG_NAME","MSG_TYPE","TypedData","constructor","typedSchema","ctxName","__typedSchema","__ctxId","generate","__schema","Object","keys","reduce","acc","key","value","__data","registerCtx","uid","setValue","prop","hasOwnProperty","console","warn","pDesc","type","nullable","pub","setMultipleValues","updObj","getValue","undefined","read","subscribe","handler","sub","remove","deleteCtx"],"sources":["/Users/David/Documents/own_projects/mp4-to-gif/node_modules/@uploadcare/blocks/abstract/TypedData.js"],"sourcesContent":["import { Data, UID } from '@symbiotejs/symbiote';\n\nconst MSG_NAME = '[Typed State] Wrong property name: ';\nconst MSG_TYPE = '[Typed State] Wrong property type: ';\n\nexport class TypedData {\n  /**\n   * @param {Object<string, { type: any; value: any; nullable?: Boolean }>} typedSchema\n   * @param {String} [ctxName]\n   */\n  constructor(typedSchema, ctxName) {\n    /** @private */\n    this.__typedSchema = typedSchema;\n    /** @private */\n    this.__ctxId = ctxName || UID.generate();\n    /** @private */\n    this.__schema = Object.keys(typedSchema).reduce((acc, key) => {\n      acc[key] = typedSchema[key].value;\n      return acc;\n    }, {});\n    /**\n     * @private\n     * @type {Data}\n     */\n    this.__data = Data.registerCtx(this.__schema, this.__ctxId);\n  }\n\n  /** @returns {String} */\n  get uid() {\n    return this.__ctxId;\n  }\n\n  /**\n   * @param {String} prop\n   * @param {any} value\n   */\n  setValue(prop, value) {\n    if (!this.__typedSchema.hasOwnProperty(prop)) {\n      console.warn(MSG_NAME + prop);\n      return;\n    }\n    let pDesc = this.__typedSchema[prop];\n    if (value?.constructor === pDesc.type || value instanceof pDesc.type || (pDesc.nullable && value === null)) {\n      this.__data.pub(prop, value);\n      return;\n    }\n    console.warn(MSG_TYPE + prop);\n  }\n\n  /** @param {Object<string, any>} updObj */\n  setMultipleValues(updObj) {\n    for (let prop in updObj) {\n      this.setValue(prop, updObj[prop]);\n    }\n  }\n\n  /** @param {String} prop */\n  getValue(prop) {\n    if (!this.__typedSchema.hasOwnProperty(prop)) {\n      console.warn(MSG_NAME + prop);\n      return undefined;\n    }\n    return this.__data.read(prop);\n  }\n\n  /**\n   * @param {String} prop\n   * @param {(newVal: any) => void} handler\n   */\n  subscribe(prop, handler) {\n    return this.__data.sub(prop, handler);\n  }\n\n  remove() {\n    Data.deleteCtx(this.__ctxId);\n  }\n}\n"],"mappings":"AAAA,SAASA,IAAI,EAAEC,GAAG,QAAQ,sBAAsB;AAEhD,MAAMC,QAAQ,GAAG,qCAAqC;AACtD,MAAMC,QAAQ,GAAG,qCAAqC;AAEtD,OAAO,MAAMC,SAAS,CAAC;EACrB;AACF;AACA;AACA;EACEC,WAAWA,CAACC,WAAW,EAAEC,OAAO,EAAE;IAChC;IACA,IAAI,CAACC,aAAa,GAAGF,WAAW;IAChC;IACA,IAAI,CAACG,OAAO,GAAGF,OAAO,IAAIN,GAAG,CAACS,QAAQ,CAAC,CAAC;IACxC;IACA,IAAI,CAACC,QAAQ,GAAGC,MAAM,CAACC,IAAI,CAACP,WAAW,CAAC,CAACQ,MAAM,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;MAC5DD,GAAG,CAACC,GAAG,CAAC,GAAGV,WAAW,CAACU,GAAG,CAAC,CAACC,KAAK;MACjC,OAAOF,GAAG;IACZ,CAAC,EAAE,CAAC,CAAC,CAAC;IACN;AACJ;AACA;AACA;IACI,IAAI,CAACG,MAAM,GAAGlB,IAAI,CAACmB,WAAW,CAAC,IAAI,CAACR,QAAQ,EAAE,IAAI,CAACF,OAAO,CAAC;EAC7D;;EAEA;EACA,IAAIW,GAAGA,CAAA,EAAG;IACR,OAAO,IAAI,CAACX,OAAO;EACrB;;EAEA;AACF;AACA;AACA;EACEY,QAAQA,CAACC,IAAI,EAAEL,KAAK,EAAE;IACpB,IAAI,CAAC,IAAI,CAACT,aAAa,CAACe,cAAc,CAACD,IAAI,CAAC,EAAE;MAC5CE,OAAO,CAACC,IAAI,CAACvB,QAAQ,GAAGoB,IAAI,CAAC;MAC7B;IACF;IACA,IAAII,KAAK,GAAG,IAAI,CAAClB,aAAa,CAACc,IAAI,CAAC;IACpC,IAAIL,KAAK,EAAEZ,WAAW,KAAKqB,KAAK,CAACC,IAAI,IAAIV,KAAK,YAAYS,KAAK,CAACC,IAAI,IAAKD,KAAK,CAACE,QAAQ,IAAIX,KAAK,KAAK,IAAK,EAAE;MAC1G,IAAI,CAACC,MAAM,CAACW,GAAG,CAACP,IAAI,EAAEL,KAAK,CAAC;MAC5B;IACF;IACAO,OAAO,CAACC,IAAI,CAACtB,QAAQ,GAAGmB,IAAI,CAAC;EAC/B;;EAEA;EACAQ,iBAAiBA,CAACC,MAAM,EAAE;IACxB,KAAK,IAAIT,IAAI,IAAIS,MAAM,EAAE;MACvB,IAAI,CAACV,QAAQ,CAACC,IAAI,EAAES,MAAM,CAACT,IAAI,CAAC,CAAC;IACnC;EACF;;EAEA;EACAU,QAAQA,CAACV,IAAI,EAAE;IACb,IAAI,CAAC,IAAI,CAACd,aAAa,CAACe,cAAc,CAACD,IAAI,CAAC,EAAE;MAC5CE,OAAO,CAACC,IAAI,CAACvB,QAAQ,GAAGoB,IAAI,CAAC;MAC7B,OAAOW,SAAS;IAClB;IACA,OAAO,IAAI,CAACf,MAAM,CAACgB,IAAI,CAACZ,IAAI,CAAC;EAC/B;;EAEA;AACF;AACA;AACA;EACEa,SAASA,CAACb,IAAI,EAAEc,OAAO,EAAE;IACvB,OAAO,IAAI,CAAClB,MAAM,CAACmB,GAAG,CAACf,IAAI,EAAEc,OAAO,CAAC;EACvC;EAEAE,MAAMA,CAAA,EAAG;IACPtC,IAAI,CAACuC,SAAS,CAAC,IAAI,CAAC9B,OAAO,CAAC;EAC9B;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}