{"ast":null,"code":"import { createCdnUrl, createCdnUrlModifiers } from '../../../utils/cdn-utils.js';\nimport { transformationsToOperations } from './lib/transformationUtils.js';\nimport { TRANSPARENT_PIXEL_SRC } from '../../../utils/transparentPixelSrc.js';\n\n/** @param {import('./CloudEditor.js').CloudEditor} fnCtx */\nexport function initState(fnCtx) {\n  return {\n    '*originalUrl': null,\n    '*faderEl': null,\n    '*cropperEl': null,\n    '*imgEl': null,\n    '*imgContainerEl': null,\n    '*networkProblems': false,\n    '*imageSize': null,\n    /** @type {import('./types.js').Transformations} */\n    '*editorTransformations': {},\n    entry: null,\n    extension: null,\n    editorMode: false,\n    modalCaption: '',\n    isImage: false,\n    msg: '',\n    src: TRANSPARENT_PIXEL_SRC,\n    fileType: '',\n    showLoader: false,\n    uuid: null,\n    cdnUrl: null,\n    'presence.networkProblems': false,\n    'presence.modalCaption': true,\n    'presence.editorToolbar': false,\n    'presence.viewerToolbar': true,\n    // TODO: beware of wrong ctx in case of element re-creation:\n    '*on.retryNetwork': () => {\n      let images = fnCtx.querySelectorAll('img');\n      for (let img of images) {\n        let originalSrc = img.src;\n        img.src = TRANSPARENT_PIXEL_SRC;\n        img.src = originalSrc;\n      }\n      fnCtx.$['*networkProblems'] = false;\n    },\n    '*on.apply': transformations => {\n      if (!transformations) {\n        return;\n      }\n      let originalUrl = fnCtx.$['*originalUrl'];\n      let cdnUrlModifiers = createCdnUrlModifiers(transformationsToOperations(transformations));\n      let cdnUrl = createCdnUrl(originalUrl, createCdnUrlModifiers(cdnUrlModifiers, 'preview'));\n\n      /** @type {import('./types.js').ApplyResult} */\n      let eventData = {\n        originalUrl,\n        cdnUrlModifiers,\n        cdnUrl,\n        transformations\n      };\n      fnCtx.dispatchEvent(new CustomEvent('apply', {\n        detail: eventData,\n        bubbles: true,\n        composed: true\n      }));\n      fnCtx.remove();\n    },\n    '*on.cancel': () => {\n      fnCtx.remove();\n      fnCtx.dispatchEvent(new CustomEvent('cancel', {\n        bubbles: true,\n        composed: true\n      }));\n    }\n  };\n}","map":{"version":3,"names":["createCdnUrl","createCdnUrlModifiers","transformationsToOperations","TRANSPARENT_PIXEL_SRC","initState","fnCtx","entry","extension","editorMode","modalCaption","isImage","msg","src","fileType","showLoader","uuid","cdnUrl","*on.retryNetwork","images","querySelectorAll","img","originalSrc","$","transformations","originalUrl","cdnUrlModifiers","eventData","dispatchEvent","CustomEvent","detail","bubbles","composed","remove","*on.cancel"],"sources":["/Users/David/Documents/own_projects/mp4-to-gif/node_modules/@uploadcare/blocks/blocks/CloudImageEditor/src/state.js"],"sourcesContent":["import { createCdnUrl, createCdnUrlModifiers } from '../../../utils/cdn-utils.js';\nimport { transformationsToOperations } from './lib/transformationUtils.js';\nimport { TRANSPARENT_PIXEL_SRC } from '../../../utils/transparentPixelSrc.js';\n\n/** @param {import('./CloudEditor.js').CloudEditor} fnCtx */\nexport function initState(fnCtx) {\n  return {\n    '*originalUrl': null,\n    '*faderEl': null,\n    '*cropperEl': null,\n    '*imgEl': null,\n    '*imgContainerEl': null,\n    '*networkProblems': false,\n    '*imageSize': null,\n    /** @type {import('./types.js').Transformations} */\n    '*editorTransformations': {},\n\n    entry: null,\n    extension: null,\n    editorMode: false,\n    modalCaption: '',\n    isImage: false,\n    msg: '',\n    src: TRANSPARENT_PIXEL_SRC,\n    fileType: '',\n    showLoader: false,\n    uuid: null,\n    cdnUrl: null,\n\n    'presence.networkProblems': false,\n    'presence.modalCaption': true,\n    'presence.editorToolbar': false,\n    'presence.viewerToolbar': true,\n    // TODO: beware of wrong ctx in case of element re-creation:\n    '*on.retryNetwork': () => {\n      let images = fnCtx.querySelectorAll('img');\n      for (let img of images) {\n        let originalSrc = img.src;\n        img.src = TRANSPARENT_PIXEL_SRC;\n        img.src = originalSrc;\n      }\n      fnCtx.$['*networkProblems'] = false;\n    },\n    '*on.apply': (transformations) => {\n      if (!transformations) {\n        return;\n      }\n      let originalUrl = fnCtx.$['*originalUrl'];\n      let cdnUrlModifiers = createCdnUrlModifiers(transformationsToOperations(transformations));\n      let cdnUrl = createCdnUrl(originalUrl, createCdnUrlModifiers(cdnUrlModifiers, 'preview'));\n\n      /** @type {import('./types.js').ApplyResult} */\n      let eventData = {\n        originalUrl,\n        cdnUrlModifiers,\n        cdnUrl,\n        transformations,\n      };\n      fnCtx.dispatchEvent(\n        new CustomEvent('apply', {\n          detail: eventData,\n          bubbles: true,\n          composed: true,\n        })\n      );\n      fnCtx.remove();\n    },\n    '*on.cancel': () => {\n      fnCtx.remove();\n\n      fnCtx.dispatchEvent(\n        new CustomEvent('cancel', {\n          bubbles: true,\n          composed: true,\n        })\n      );\n    },\n  };\n}\n"],"mappings":"AAAA,SAASA,YAAY,EAAEC,qBAAqB,QAAQ,6BAA6B;AACjF,SAASC,2BAA2B,QAAQ,8BAA8B;AAC1E,SAASC,qBAAqB,QAAQ,uCAAuC;;AAE7E;AACA,OAAO,SAASC,SAASA,CAACC,KAAK,EAAE;EAC/B,OAAO;IACL,cAAc,EAAE,IAAI;IACpB,UAAU,EAAE,IAAI;IAChB,YAAY,EAAE,IAAI;IAClB,QAAQ,EAAE,IAAI;IACd,iBAAiB,EAAE,IAAI;IACvB,kBAAkB,EAAE,KAAK;IACzB,YAAY,EAAE,IAAI;IAClB;IACA,wBAAwB,EAAE,CAAC,CAAC;IAE5BC,KAAK,EAAE,IAAI;IACXC,SAAS,EAAE,IAAI;IACfC,UAAU,EAAE,KAAK;IACjBC,YAAY,EAAE,EAAE;IAChBC,OAAO,EAAE,KAAK;IACdC,GAAG,EAAE,EAAE;IACPC,GAAG,EAAET,qBAAqB;IAC1BU,QAAQ,EAAE,EAAE;IACZC,UAAU,EAAE,KAAK;IACjBC,IAAI,EAAE,IAAI;IACVC,MAAM,EAAE,IAAI;IAEZ,0BAA0B,EAAE,KAAK;IACjC,uBAAuB,EAAE,IAAI;IAC7B,wBAAwB,EAAE,KAAK;IAC/B,wBAAwB,EAAE,IAAI;IAC9B;IACA,kBAAkB,EAAEC,CAAA,KAAM;MACxB,IAAIC,MAAM,GAAGb,KAAK,CAACc,gBAAgB,CAAC,KAAK,CAAC;MAC1C,KAAK,IAAIC,GAAG,IAAIF,MAAM,EAAE;QACtB,IAAIG,WAAW,GAAGD,GAAG,CAACR,GAAG;QACzBQ,GAAG,CAACR,GAAG,GAAGT,qBAAqB;QAC/BiB,GAAG,CAACR,GAAG,GAAGS,WAAW;MACvB;MACAhB,KAAK,CAACiB,CAAC,CAAC,kBAAkB,CAAC,GAAG,KAAK;IACrC,CAAC;IACD,WAAW,EAAGC,eAAe,IAAK;MAChC,IAAI,CAACA,eAAe,EAAE;QACpB;MACF;MACA,IAAIC,WAAW,GAAGnB,KAAK,CAACiB,CAAC,CAAC,cAAc,CAAC;MACzC,IAAIG,eAAe,GAAGxB,qBAAqB,CAACC,2BAA2B,CAACqB,eAAe,CAAC,CAAC;MACzF,IAAIP,MAAM,GAAGhB,YAAY,CAACwB,WAAW,EAAEvB,qBAAqB,CAACwB,eAAe,EAAE,SAAS,CAAC,CAAC;;MAEzF;MACA,IAAIC,SAAS,GAAG;QACdF,WAAW;QACXC,eAAe;QACfT,MAAM;QACNO;MACF,CAAC;MACDlB,KAAK,CAACsB,aAAa,CACjB,IAAIC,WAAW,CAAC,OAAO,EAAE;QACvBC,MAAM,EAAEH,SAAS;QACjBI,OAAO,EAAE,IAAI;QACbC,QAAQ,EAAE;MACZ,CAAC,CACH,CAAC;MACD1B,KAAK,CAAC2B,MAAM,CAAC,CAAC;IAChB,CAAC;IACD,YAAY,EAAEC,CAAA,KAAM;MAClB5B,KAAK,CAAC2B,MAAM,CAAC,CAAC;MAEd3B,KAAK,CAACsB,aAAa,CACjB,IAAIC,WAAW,CAAC,QAAQ,EAAE;QACxBE,OAAO,EAAE,IAAI;QACbC,QAAQ,EAAE;MACZ,CAAC,CACH,CAAC;IACH;EACF,CAAC;AACH","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}